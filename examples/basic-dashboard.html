<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Basic Dashboard - DevDashboard Example</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
    }
    
    header {
      background-color: #2196f3;
      color: white;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .header-title {
      margin: 0;
      font-size: 1.5rem;
    }
    
    .header-links {
      display: flex;
      gap: 1rem;
    }
    
    .header-link {
      color: white;
      text-decoration: none;
      font-size: 0.9rem;
      opacity: 0.9;
    }
    
    .header-link:hover {
      opacity: 1;
      text-decoration: underline;
    }
    
    main {
      padding: 1rem;
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .controls {
      margin-bottom: 1rem;
      display: flex;
      gap: 1rem;
      align-items: center;
      background-color: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .control-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    select, button {
      padding: 0.5rem;
      border-radius: 4px;
      border: 1px solid #ccc;
      background-color: white;
      font-size: 0.9rem;
    }
    
    button {
      cursor: pointer;
      background-color: #2196f3;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      font-weight: bold;
      transition: background-color 0.2s;
    }
    
    button:hover {
      background-color: #0d8aee;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .dashboard-card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .dashboard-card:nth-child(1) {
      grid-column: 1 / 3;
      height: 300px;
    }
    
    .dashboard-card:nth-child(2),
    .dashboard-card:nth-child(3) {
      height: 400px;
    }
    
    .card-header {
      padding: 1rem;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .card-title {
      margin: 0;
      font-size: 1rem;
      font-weight: bold;
    }
    
    .card-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .card-action {
      background: none;
      border: none;
      cursor: pointer;
      color: #666;
      padding: 0.25rem;
      border-radius: 4px;
    }

    .card-content {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .viz-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    .card-action:hover {
      background-color: #f5f5f5;
      color: #333;
    }
    
    .card-content {
      height: calc(100% - 56px);
    }
    
    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .dashboard-card:nth-child(1) {
        grid-column: auto;
      }
      
      .controls {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1 class="header-title">Basic Dashboard Example</h1>
    <div class="header-links">
      <a href="/examples" class="header-link">Back to Examples</a>
      <a href="https://github.com/yourusername/dev-dashboard" class="header-link">GitHub</a>
    </div>
  </header>
  
  <main>
    <div class="controls">
      <div class="control-group">
        <label for="theme">Theme:</label>
        <select id="theme">
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="ocean">Ocean</option>
        </select>
      </div>
      
      <div class="control-group">
        <label for="timeRange">Time Range:</label>
        <select id="timeRange">
          <option value="daily">Daily</option>
          <option value="weekly">Weekly</option>
          <option value="monthly">Monthly</option>
        </select>
      </div>
      
      <button id="refreshData">Refresh Data</button>
    </div>
    
    <div id="dashboard" class="dashboard">
      <div class="dashboard-card">
        <div class="card-header">
          <h2 class="card-title">Commit Frequency</h2>
          <div class="card-actions">
            <button class="card-action" title="Download CSV">ðŸ“¥</button>
            <button class="card-action" title="View Fullscreen">â›¶</button>
          </div>
        </div>
        <div class="card-content">
          <div id="commit-chart" style="width: 100%; height: 100%;"></div>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-header">
          <h2 class="card-title">Code Quality</h2>
          <div class="card-actions">
            <button class="card-action" title="Download CSV">ðŸ“¥</button>
            <button class="card-action" title="View Fullscreen">â›¶</button>
          </div>
        </div>
        <div class="card-content">
          <div id="code-quality" style="width: 100%; height: 100%;"></div>
        </div>
      </div>
      
      <div class="dashboard-card">
        <div class="card-header">
          <h2 class="card-title">Sprint Velocity</h2>
          <div class="card-actions">
            <button class="card-action" title="Download CSV">ðŸ“¥</button>
            <button class="card-action" title="View Fullscreen">â›¶</button>
          </div>
        </div>
        <div class="card-content">
          <div id="velocity-chart" style="width: 100%; height: 100%;"></div>
        </div>
      </div>
    </div>
  </main>
  
  <script type="module">
    import { DevDashboard, ThemeManager, DataProcessor } from '../dist/dev-dashboard.esm.js';
    
    // Sample data generators
    const generateCommitData = (days = 30) => {
      const commits = [];
      const date = new Date();
      date.setDate(date.getDate() - days);
      
      for (let i = 0; i < days; i++) {
        date.setDate(date.getDate() + 1);
        
        // Random commit count (more commits on weekdays)
        const isWeekend = date.getDay() === 0 || date.getDay() === 6;
        const count = Math.floor(Math.random() * (isWeekend ? 5 : 15)) + (isWeekend ? 0 : 5);
        
        // Add commits
        for (let j = 0; j < count; j++) {
          commits.push({
            id: `commit-${i}-${j}`,
            date: new Date(date),
            author: `developer${Math.floor(Math.random() * 5) + 1}@example.com`,
            repository: ['main-app', 'api', 'docs', 'ui-components'][Math.floor(Math.random() * 4)],
            message: `Commit message ${i}-${j}`
          });
        }
      }
      
      return commits;
    };
    
    const generateCodeQualityData = (days = 30) => {
      const data = [];
      const date = new Date();
      date.setDate(date.getDate() - days);
      
      // Start with some baseline values
      let bugs = 15;
      let vulnerabilities = 8;
      let codeSmells = 120;
      let coverage = 75;
      
      for (let i = 0; i < days; i++) {
        date.setDate(date.getDate() + 1);
        
        // Randomly adjust values (mostly improving over time)
        bugs = Math.max(0, bugs + (Math.random() > 0.7 ? 1 : -1));
        vulnerabilities = Math.max(0, vulnerabilities + (Math.random() > 0.8 ? 1 : -1));
        codeSmells = Math.max(0, codeSmells + (Math.random() > 0.6 ? 5 : -8));
        coverage = Math.min(100, Math.max(0, coverage + (Math.random() > 0.3 ? 0.5 : -0.2)));
        
        data.push({
          date: new Date(date),
          bugs,
          vulnerabilities,
          codeSmells,
          coverage: Math.round(coverage * 10) / 10
        });
      }
      
      return data;
    };
    
    const generateStoryPointsData = (sprints = 8) => {
      const data = [];
      
      for (let i = 1; i <= sprints; i++) {
        // Total points between 20-40
        const totalPoints = Math.floor(Math.random() * 20) + 20;
        
        // Completion rate between 60-100%
        const completionRate = Math.random() * 0.4 + 0.6;
        const completedPoints = Math.floor(totalPoints * completionRate);
        
        // Number of stories between 5-15
        const storiesCount = Math.floor(Math.random() * 10) + 5;
        
        // Create stories
        for (let j = 1; j <= storiesCount; j++) {
          const storyPoints = Math.floor(Math.random() * 8) + 1;
          const isCompleted = j <= Math.floor(storiesCount * completionRate);
          
          data.push({
            sprint: `Sprint ${i}`,
            id: `story-${i}-${j}`,
            title: `Story ${i}-${j}`,
            points: storyPoints,
            status: isCompleted ? 'done' : Math.random() > 0.5 ? 'in-progress' : 'todo'
          });
        }
      }
      
      return data;
    };
    
    // Initialize dashboard
    const dashboard = new DevDashboard({
      container: '#dashboard',
      theme: 'light'
    });
    
    // Get time range
    const timeRangeSelect = document.getElementById('timeRange');
    const getTimeRange = () => timeRangeSelect.value;
    
    // Process data
    let commitData = generateCommitData(30);
    let qualityData = generateCodeQualityData(30);
    let storyPointsData = generateStoryPointsData(8);
    
    const processData = () => {
      const timeRange = getTimeRange();
      
      // Process commit data
      const processedCommitData = DataProcessor.processCommitData(commitData, {
        timeRange
      });
      
      // Process code quality data
      const processedQualityData = DataProcessor.processCodeQualityData(qualityData);
      
      // Process story points data
      const processedStoryPointsData = DataProcessor.processStoryPointsData(storyPointsData);
      
      return {
        commits: processedCommitData,
        quality: processedQualityData,
        storyPoints: processedStoryPointsData
      };
    };
    
    // Add visualizations
    const initializeVisualizations = () => {
      const data = processData();
      
      // Add commit frequency chart
      dashboard.addVisualization({
        id: 'commit-frequency',
        type: 'commitFrequency',
        data: data.commits,
        options: {
          timeRange: getTimeRange(),
          xAxisLabel: 'Date',
          yAxisLabel: 'Commits'
        }
      });
      
      // Add code quality chart
      dashboard.addVisualization({
        id: 'code-quality',
        type: 'codeQuality',
        data: data.quality,
        options: {
          metrics: ['bugs', 'vulnerabilities', 'codeSmells', 'coverage'],
          xAxisLabel: 'Date',
          yAxisLabel: 'Issues'
        }
      });
      
      // Add velocity chart
      dashboard.addVisualization({
        id: 'velocity',
        type: 'velocity',
        data: data.storyPoints,
        options: {
          showVelocity: true,
          velocityWindow: 3,
          xAxisLabel: 'Sprint',
          yAxisLabel: 'Story Points'
        }
      });
    };
    
    // Update data
    const updateData = () => {
      const data = processData();
      
      // Update commit frequency chart
      dashboard.updateData('commit-frequency', data.commits);
      
      // Update code quality chart
      dashboard.updateData('code-quality', data.quality);
      
      // Update velocity chart
      dashboard.updateData('velocity', data.storyPoints);
    };
    
    // Handle theme change
    const themeSelect = document.getElementById('theme');
    themeSelect.addEventListener('change', () => {
      dashboard.setTheme(themeSelect.value);
    });
    
    // Handle time range change
    timeRangeSelect.addEventListener('change', () => {
      updateData();
    });
    
    // Handle refresh button
    const refreshButton = document.getElementById('refreshData');
    refreshButton.addEventListener('click', () => {
      // Generate new random data
      commitData = generateCommitData(30);
      qualityData = generateCodeQualityData(30);
      storyPointsData = generateStoryPointsData(8);
      
      // Update visualizations
      updateData();
    });
    
    // Add fullscreen functionality
    document.querySelectorAll('.card-action[title="View Fullscreen"]').forEach(button => {
      button.addEventListener('click', (event) => {
        const card = event.target.closest('.dashboard-card');
        if (card.requestFullscreen) {
          card.requestFullscreen();
        } else if (card.webkitRequestFullscreen) {
          card.webkitRequestFullscreen();
        } else if (card.msRequestFullscreen) {
          card.msRequestFullscreen();
        }
      });
    });
    
    // Initialize dashboard
    initializeVisualizations();
  </script>
</body>
</html>